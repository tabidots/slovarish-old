{"version":3,"sources":["slovarish/frontend/navigation.cljs"],"mappings":"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","names":["slovarish.frontend.navigation/resize-input-text","reciprocal-size","cljs.core/deref","cljs.core/count","slovarish.frontend.state/input","goog.style/setStyle","js/document","slovarish.frontend.navigation/truncated?","el","slovarish.frontend.navigation/toggle-gloss-arrows","seq__1026773","cljs.core/seq","chunk__1026774","count__1026775","i__1026776","temp__5753__auto__","cljs.core/chunked-seq?","c__4679__auto__","cljs.core/chunk-first","cljs.core/chunk-rest","cljs.core/first","cljs.core/next","goog.dom.classlist/add","goog.dom.classlist/remove","slovarish.frontend.navigation/base-cell-colors","slovarish.frontend.navigation/color-cells-by-score","white","goog.color/hexToRgb","cells","max-score","or__4253__auto__","cljs.core.apply","cljs.core/max","p1__1026778#","cljs.core.map","factor","seq__1026779","chunk__1026781","count__1026782","i__1026783","cell","cell-type","goog.dom.classlist/contains","slovarish.frontend.state/result","base-color","score","goog.dom.classlist/removeAll","and__4251__auto__","goog.color/blend","goog.color/rgbArrayToHex","goog.dom.classlist/addAll","G__1026787","G__1026788","cljs.core/name","var_args","args__4870__auto__","len__4864__auto__","i__4865__auto__","argseq__4871__auto__","cljs.core/IndexedSeq","slovarish.frontend.navigation/go-to-word","p__1026791","map__1026792","cljs.core/--destructure-map","cljs.core.get","seq1026789","G__1026790","self__4851__auto__","word","target-pos","filter-fn","cljs.core._EQ_","slovarish.frontend.state/pos","cljs.core/reset!","slovarish.frontend.state/results","G__1026793","G__1026794","cljs.core/Keyword","slovarish.frontend.nouns.declension/declensions","fexpr__1026795","slovarish.frontend.data/all-verbs","fexpr__1026796","slovarish.frontend.data/all-adjectives","cljs.core.filter","slovarish.frontend.state/which-result?","slovarish.frontend.state/which-verb-forms?","js/setTimeout","slovarish.frontend.navigation/prev-sense","cljs.core.nth","cljs.core.swap_BANG_","cljs.core/dec","slovarish.frontend.navigation/next-sense","cljs.core/inc"],"sourcesContent":["(ns slovarish.frontend.navigation\n  (:require [reagent.core :as r]\n            [goog.dom :as gdom]\n            [goog.dom.classlist :as cl]\n            [goog.style :as style]\n            [goog.color :as gcolor]\n            [slovarish.frontend.nouns.declension :as d]\n            [slovarish.frontend.state :refer [input results which-result? result pos which-verb-forms?]]\n            [slovarish.frontend.data :refer [all-nouns all-verbs all-adjectives]]))\n\n(defn resize-input-text []\n  (let [reciprocal-size (/ 7 (* 0.08 (count @input)))]\n    (style/setStyle (.querySelector js/document \"#word-input\")\n                    \"font-size\"\n                    (str \"clamp(12px, \"\n                         (if (> reciprocal-size 7) 7 reciprocal-size) \"vw, \"\n                         \"80px)\"))))\n\n(defn truncated? [el] ; https://stackoverflow.com/a/10017343\n  (< (-> el .-offsetWidth) (-> el .-scrollWidth)))\n\n(defn toggle-gloss-arrows []\n  (doseq [el (.querySelectorAll js/document \".primary-gloss\")]\n    (if (truncated? el)\n      (cl/add el \"down-arrow\")\n      (cl/remove el \"down-arrow\"))))\n\n(def base-cell-colors\n  {:default \"#eee\"\n   :irregular-form \"#D7EBBA\"\n   :masculine \"#bdd6ff\"\n   :feminine \"#ffc2e9\"\n   :neuter \"#fff0a6\"\n   :common \"#deccf4\"})\n\n(defn color-cells-by-score []\n  (let [white     (gcolor/hexToRgb \"#fffcf5\")\n        cells     (.querySelectorAll js/document \"#noun-table td\")\n        max-score (or (apply max (map #(.getAttribute % \"data-score\") cells))\n                      1)\n        factor    (/ 1 max-score)]\n    (doseq [cell cells\n            :let [cell-type  (if (cl/contains cell \"irregular-form\")\n                               :irregular-form\n                               (or (-> (result) :gender)\n                                   :default))\n                  base-color (gcolor/hexToRgb (cell-type base-cell-colors))\n                  score      (* (or (.getAttribute cell \"data-score\") 0)\n                                factor)]]\n      (cl/removeAll cell #js[\"masculine\" \"feminine\" \"neuter\" \"common\" \"default\" \"light\" \"uncommon\"])\n      (if (and (:verified? (result)) (:wordform-scores (result)))\n        (do\n          (when (<= score 0.2) (cl/add cell \"uncommon\"))\n          (style/setStyle cell \"background-color\"\n                          (-> base-color\n                              (gcolor/blend white score)\n                              gcolor/rgbArrayToHex)))\n        (do\n          (style/setStyle cell \"background-color\" \"\")\n          (cl/addAll cell #js[\"light\"\n                              (when-not (cl/contains cell \"irregular-form\")\n                                (or (some-> (result) :gender name)\n                                    \"default\"))]))))))\n\n(defn go-to-word\n  [word & {:keys [target-pos filter-fn] :or {target-pos nil filter-fn nil}}]\n  (if (= @pos target-pos)\n    (do\n      (reset! input \"\")\n      (reset! results nil))\n    (do\n      (reset! input word)\n      (when target-pos\n        (reset! pos target-pos))\n      (reset! results (when (>= (count word) 2)\n                        (cond->> (case @pos\n                                   :noun      (d/declensions word)\n                                   :verb      (@all-verbs word)\n                                   :adjective (@all-adjectives word)\n                                   nil)\n                                 filter-fn (filter filter-fn))))))\n  (reset! which-result? 0)\n  (reset! which-verb-forms? :main)\n  (resize-input-text)\n  (js/setTimeout toggle-gloss-arrows 25)\n  (when (= @pos :noun)\n    (js/setTimeout color-cells-by-score 25)))\n\n(defn prev-sense []\n  (when (and (pos? @which-result?)\n             (nth @results (dec @which-result?)))\n    (swap! which-result? dec))\n  (when (= @pos :noun)\n    (js/setTimeout color-cells-by-score 25)))\n\n(defn next-sense []\n  (when (< (inc @which-result?) (count @results))\n    (swap! which-result? inc))\n  (when (= @pos :noun)\n    (js/setTimeout color-cells-by-score 25)))\n\n#_(defn lighten\n    ;; Generates colors for CSS - these are the \"light\" colors for unverified results\n    [factor hex]\n    (-> hex\n        gcolor/hexToRgb\n        (gcolor/lighten factor)\n        gcolor/rgbArrayToHex))\n\n#_(map #(lighten 0.62 (% base-cell-colors))\n       [:masculine :feminine :neuter :common :irregular-form])\n"]}